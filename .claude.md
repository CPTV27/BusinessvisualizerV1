# The Studio — Big Muddy Blues Hotels
## Claude Code Project Memory

> **Read this first. Every session. No exceptions.**
> This file prevents us from rebuilding what we already built.

---

## THE BIG PICTURE

```
SuperChase.app = The OS (voice command center, multi-agent orchestration)
SIDEKICK = The Brain (Flask/Python marketing agents, MCP bridge)
The Studio = The UI (React + Three.js immersive business visualizer)
Big Muddy = First Tenant (boutique hotel + live venue in Natchez, MS)
```

**What we're building**: An AI-powered creative operations platform where business strategy, marketing automation, and client experiences live inside immersive AI-generated 3D environments.

**Chase's core directive**: "I want immersive experiences, not boxes and words."

---

## MULTI-AGENT SYSTEM

### Agents
| Agent | Tool | Role | Files They Own |
|-------|------|------|----------------|
| **CC** (Claude Code) | Claude Code Max | Services, data pipelines, architecture, coordination | `services/sheetsService.ts`, `.env*`, `ARCHITECTURE.md`, `AGENT_LEDGER.md`, `REVENUE_MODEL.md`, `.claude.md` |
| **AG** (Antigravity) | Cursor + Opus 4.5 | 3D visuals, complex components, Firebase | `src/components/*`, `src/services/*`, `src/contexts/*`, `vite.config.ts`, `package.json` |
| **GA** (Google AI Studio) | Gemini | Types, constants, AI prompts | `types.ts`, `constants.ts`, `services/geminiService.ts` |

### SHARED FILES (Coordinate before editing!)
- `App.tsx` — **WAR ZONE**. Multiple merge conflicts here. Always coordinate.
- `index.css` — Shared styling.

### Protocol
1. Check in to `AGENT_LEDGER.md` before starting
2. Check out when done
3. Never edit files you don't own without coordinating first

---

## TECH STACK

```
React 19.2.4 + TypeScript 5.8 + Vite 6.2
Three.js 0.182 + React Three Fiber 9.5 + Drei 10.7
Google Generative AI (Gemini) — Ultra credits
Firebase (sidekick-bigmuddy) — Firestore, Auth, Hosting
Lucide React icons
Tailwind CSS (CDN in index.html)
```

---

## PROJECT STRUCTURE

```
BusinessvisualizerV1/
├── App.tsx                          # Main app (SHARED — coordinate!)
├── index.tsx                        # React mount point
├── index.html                       # Entry HTML with Tailwind CDN + fonts
├── types.ts                         # All TypeScript interfaces (GA owns)
├── constants.ts                     # Themes, entities, ENVIRONMENT_DESCRIPTIONS (GA owns)
├── services/
│   ├── geminiService.ts             # Gemini AI functions (GA owns)
│   └── sheetsService.ts             # Google Sheets sync (CC owns)
├── src/
│   ├── components/
│   │   ├── StudioExperience.tsx     # Flow manager: selector → world → detail (AG)
│   │   ├── ImmersiveThemeSelector.tsx # Full-screen theme picker with particles (AG)
│   │   ├── ImmersiveWorld.tsx       # 3D environment with skybox + entity orbs (AG)
│   │   ├── EntityMarkers3D.tsx      # Interactive floating entity markers (AG)
│   │   └── GameBoard.tsx            # 5-view strategic board (AG)
│   ├── contexts/
│   │   └── ThemeEnvironmentContext.tsx # Skybox caching + environment state (AG)
│   └── services/
│       ├── ambientService.ts        # Soundscapes + particles per theme (AG)
│       └── firebaseService.ts       # Auth + Firestore CRUD (AG)
├── .env.local                       # API keys (GEMINI_API_KEY) — GITIGNORED
├── ARCHITECTURE.md                  # Master architecture doc (CC)
├── AGENT_LEDGER.md                  # Session tracking (CC)
├── REVENUE_MODEL.md                 # Business model (CC)
└── vite.config.ts                   # Vite config with env var injection
```

---

## KEY TYPES (in types.ts)

- `ThemeId`: LOBBY | GARDEN | JUKE_JOINT | EDITORIAL
- `EntityType`: VENUE | BRAND | EXPERIENCE | DEVELOPMENT | PACKAGE | PROGRAM | ROOM_CATEGORY
- `ServiceLayer`: FOUNDATION | NETWORK | MACHINE | BUSINESS
- `BusinessEntity`: Core data model (16 entities in constants.ts)
- `EnvironmentConfig`: Skybox URL, mood, ambient color, fog, particles
- `EntityMarker3D`: 3D position, scale, glow for Three.js markers
- `MoodType`: 'day' | 'evening' | 'night'

---

## KEY CONSTANTS (in constants.ts)

- `THEMES`: 4 art-directed theme configs (colors, fonts, styles)
- `INITIAL_ENTITIES`: 16 business entities with coordinates, KPIs, gaps
- `ENVIRONMENT_DESCRIPTIONS`: Rich prompt descriptions per theme × entity type × mood for Gemini panoramic generation

---

## KEY SERVICES (in services/geminiService.ts)

| Function | Purpose |
|----------|---------|
| `generateGapSolutions()` | Strategic solutions for business gaps |
| `generateEntityVisual()` | Photorealistic entity images |
| `modifyRoomScenario()` | Room image editing via text prompt |
| `performMarketAnalysis()` | Competitive landscape with Ghost Concept |
| `generateReel()` | Veo 3.1 video generation |
| `sendEntityChatMessage()` | Entity-specific AI chat |
| `generatePanoramicEnvironment()` | 360 equirectangular skybox for Three.js |
| `generateLayerEnvironments()` | Batch skybox generation with progress |

---

## APP FLOW

1. **Theme Selector** → StudioExperience renders ImmersiveThemeSelector (4 full-screen atmospheric territories)
2. **Enter World** → StudioExperience renders ImmersiveWorld (3D skybox + floating entity orbs)
3. **Click Entity** → App.tsx renders EntityDetailView (map/space views, visual command line, chat notebook)
4. **Fallback** → If Gemini API fails or no key, gradient backgrounds from FALLBACK_GRADIENTS

---

## VITE CONFIG NOTES

- `process.env.API_KEY` is injected via `vite.config.ts` `define` block from `.env.local` `GEMINI_API_KEY`
- `process.env.GEMINI_API_KEY` also injected as alias
- Dev server runs on port 3000, host 0.0.0.0
- Path alias `@/` maps to project root

---

## REVENUE MODEL (Summary)

**Big Muddy Year 1**: $4.34M (Lodging $1.49M, Entertainment $850K, F&B $1.57M, Packages $150K, Products $280K)
**Year 3**: $6.23M
**Platform SaaS**: Starter $299/mo, Professional $799/mo, Enterprise $2,499/mo
**SIDEKICK operational savings**: $54.3K/year (7.5x ROI on AI costs)

---

## DEPLOYMENT

- **GitHub**: CPTV27 org, BusinessvisualizerV1 repo
- **Firebase**: sidekick-bigmuddy project
- **Dev server**: `npm run dev` → localhost:3000
- **Build**: `npm run build` → dist/

---

## EXTERNAL SYSTEMS

| System | Status | Notes |
|--------|--------|-------|
| SIDEKICK Backend | Working | Flask/Python at /projects/TheBigMuddy_SIDEKICK |
| SIDEKICK-MCP | Working | Node.js bridge, 25+ tools exposed to Claude |
| superchase.app | Live (1.39k visitors) | Voice command center |
| Google Sheets | Pending OAuth | Discovery Model data source |
| 1Password CLI | Needs setup | me@chasepierson.tv account not added |
| Limitless Lifelog | App installed | Needs API key from limitless.ai/developers |

---

## KNOWN ISSUES & LESSONS

1. **App.tsx is a collision zone** — GA and AG both edited it, causing merge conflict. Always coordinate.
2. **AG's components use local ThemeId enums** — To avoid import path issues between `src/` and root `types.ts`. This is intentional.
3. **ThemeEnvironmentContext uses dynamic import** — `import('../../services/geminiService')` to avoid SSR issues with Three.js
4. **Gemini API key** — Must be in `.env.local` as `GEMINI_API_KEY`. Vite injects it as `process.env.API_KEY`.
5. **scoutRegionalBusinesses** — Was imported in App.tsx but never exported from geminiService. Removed 2026-02-06.
6. **Three.js bundle size** — ~1.4MB after minification. Future: code-split with dynamic imports.
7. **No index.css** — Tailwind is loaded via CDN in index.html. Custom scrollbar styles inline in `<style>` tag.

---

## WHAT'S BEEN BUILT (as of 2026-02-06)

- [x] 4-layer business entity model (16 entities across Foundation/Business/Network/Machine)
- [x] Immersive 3D theme selector (full-screen particle-driven territories)
- [x] ImmersiveWorld with Three.js skybox + floating entity orbs
- [x] StudioExperience flow manager (selector → world → detail)
- [x] Panoramic environment generator with ENVIRONMENT_DESCRIPTIONS
- [x] Google Sheets live sync service (Discovery Model pipeline)
- [x] Firebase service (auth, Firestore CRUD, multi-client)
- [x] Ambient soundscape system (per-theme audio + particles)
- [x] GameBoard with 5 strategic views
- [x] Market analysis with Ghost Concept competitor mapping
- [x] Veo 3.1 video reel generator
- [x] Entity chat notebook (persistent AI conversations per entity)
- [x] Visual command line (text-prompt room modifications)
- [x] Architecture, revenue model, and agent ledger documentation

## WHAT'S NOT DONE

- [ ] Google Workspace OAuth (needs browser on Mac Mini for localhost callback)
- [ ] 1Password CLI wiring (personal account not connected)
- [ ] Limitless lifelog integration (needs API key)
- [ ] Entity detail → 3D world back-navigation (currently one-way)
- [ ] Code splitting for Three.js bundle
- [ ] Firebase deployment of The Studio
- [ ] Connect StudioExperience to actual generated skyboxes (currently gradient fallback until API key works)

---

## HOW TO RUN

```bash
cd /Users/chasethis/superchase/BusinessvisualizerV1
npm run dev
# Opens at http://localhost:3000
```

Requires `.env.local` with:
```
GEMINI_API_KEY=your-key-here
```

---

## RELATED PROJECTS

| Project | Path | Purpose |
|---------|------|---------|
| TheBigMuddy_SIDEKICK | /Users/chasethis/projects/TheBigMuddy_SIDEKICK | SIDEKICK agent backend (Flask/Python) |
| SIDEKICK-MCP | /Users/chasethis/projects/sidekick-site | Claude ↔ SIDEKICK bridge (Node.js) |
| sidekick-marketing-site | /Users/chasethis/projects/sidekick-marketing-site | Big Muddy operations dashboard |
| superchase (voice) | /Users/chasethis/Documents/Systems/superchase | LLM Council + voice command system |
| Deltadawn Discovery App | /Users/chasethis/projects/Deltadawn discovery App | Origin Discovery Model (Excel) |

---

*Updated: 2026-02-06 by CC (Claude Code). Keep this current — it's our memory.*
